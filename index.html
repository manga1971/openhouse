<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LumiYE – Bun venit</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    /* Stiluri generale pentru corp și HTML, fără overflow pentru o experiență imersivă */
    body, html {
      margin: 0;
      padding: 0;
      overflow: hidden;
      font-family: 'Inter', sans-serif; /* Folosim fontul Inter, conform discuției */
      background-color: #FDFBF6; /* Fundal bej cald */
      color: #2E2E2E; /* Text gri foarte închis */
    }
    /* Stiluri pentru butoanele de navigare cu efect de sticlă */
    .glass-button {
      @apply backdrop-blur-xl bg-white/10 border border-white/30 rounded-full text-sm shadow-lg flex items-center justify-center;
      transition: transform 0.3s ease, background-color 0.3s;
      color: #2E2E2E; /* Culoarea textului pentru butoanele de sticlă */
    }
    .glass-button:hover {
      background-color: rgba(255, 255, 255, 0.15);
    }
    /* Stiluri pentru "soare" - butonul central de înregistrare */
    .sun {
      @apply absolute rounded-full bg-yellow-300 shadow-2xl;
      width: 160px;
      height: 160px;
      transition: all 0.8s ease-in-out;
      z-index: 10; /* Asigură că este deasupra altor elemente */
    }
    /* Animația de expansiune a soarelui */
    .sun.expanding {
      width: 100vw;
      height: 100vh;
      left: 0 !important;
      top: 0 !important;
      border-radius: 0;
      z-index: 50; /* Aduce soarele în prim-plan maxim */
      background-color: #C7EDE6; /* Culoarea de accent verde mentă la expansiune */
    }
    /* Stiluri pentru egalizatorul audio */
    .equalizer {
      display: flex;
      justify-content: center;
      align-items: end;
      height: 40px;
      gap: 4px;
      margin-top: 12px;
    }
    .bar {
      width: 4px;
      height: 10px;
      background: #C7EDE6; /* Culoarea de accent verde mentă pentru bare */
      animation: bounce 1s infinite ease-in-out;
    }
    .bar:nth-child(2) { animation-delay: 0.1s; }
    .bar:nth-child(3) { animation-delay: 0.2s; }
    .bar:nth-child(4) { animation-delay: 0.3s; }
    .bar:nth-child(5) { animation-delay: 0.4s; }
    /* Animația de "săritură" a barelor egalizatorului */
    @keyframes bounce {
      0%, 100% { transform: scaleY(1); }
      50% { transform: scaleY(2); }
    }
    /* Ascunde secțiunea de înregistrare inițial */
    #rec-section {
      display: none;
    }
    /* Afișează secțiunea de înregistrare când soarele este "activ" */
    #sun.active + #rec-section {
      display: flex; /* Folosim flex pentru a centra conținutul */
    }

    /* Stiluri pentru modalul de inspirație */
    .modal {
      display: none; /* Ascuns implicit */
      position: fixed; /* Poziționat fix pe ecran */
      z-index: 100; /* Deasupra tuturor elementelor */
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto; /* Permite scroll dacă conținutul este prea mare */
      background-color: rgba(0,0,0,0.4); /* Fundal semi-transparent */
      backdrop-filter: blur(5px); /* Efect de blur */
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .modal-content {
      background-color: #FDFBF6; /* Fundal bej cald */
      margin: auto;
      padding: 20px;
      border-radius: 12px;
      width: 90%;
      max-width: 500px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      position: relative;
      color: #2E2E2E;
    }
    .close-button {
      color: #aaa;
      position: absolute;
      top: 10px;
      right: 15px;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }
    .close-button:hover,
    .close-button:focus {
      color: #2E2E2E;
      text-decoration: none;
      cursor: pointer;
    }
    .loading-spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #C7EDE6; /* Verde mentă */
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
      display: none; /* Ascuns implicit */
    }
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="relative w-screen h-screen flex flex-col items-center justify-center">
  <!-- Mesajul de bun venit și introducere, conform discuției -->
  <div class="absolute top-1/4 text-center px-4 z-10">
    <h1 class="text-3xl font-semibold text-gray-800">Bun venit în spațiul tău</h1>
    <p class="mt-4 text-lg max-w-md mx-auto italic opacity-90">
      LumiYE este o evadare din prezentul agitat. Un loc în care poți să respiri, să simți, să fii.
    </p>
    <p class="mt-4 text-base max-w-sm mx-auto opacity-70">
      Fie că vrei să păstrezi o stare de bine sau să descarci ceva ce te apasă, <strong>acum</strong> e momentul.
    </p>
  </div>

  <!-- Butonul central "soare" pentru a începe sesiunea -->
  <div id="sun" class="sun left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 flex items-center justify-center text-white text-lg font-semibold cursor-pointer">
    <span id="sun-text">🎙️ Începe Sesiunea</span>
  </div>

  <!-- Butoanele de navigare (planete), stilizate ca "glass-button" -->
  <a href="journal.html" class="glass-button absolute top-16 right-12 w-16 h-16">Jurnal</a>
  <a href="mygoals.html" class="glass-button absolute top-1/2 right-8 transform -translate-y-1/2 w-16 h-16">Obiective</a>
  <a href="reports.html" class="glass-button absolute bottom-24 left-12 w-16 h-16">Raport</a>
  <a href="history.html" class="glass-button absolute top-1/3 left-16 w-12 h-12">Istoric</a>

  <!-- Noul buton pentru inspirație rapidă cu Gemini API -->
  <button id="inspirationButton" class="glass-button absolute bottom-16 right-16 w-24 h-24 text-lg">✨ Inspirație</button>

  <!-- Egalizatorul și textul de stare (vizibile doar la înregistrare activă) -->
  <div id="rec-section" class="absolute bottom-6 w-full flex-col items-center z-10 text-sm">
    <div class="equalizer">
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
      <div class="bar"></div>
    </div>
    <p class="mt-2 text-center px-4" id="status-msg">
      Se memorizează starea ta actuală.<br />
      <span class="opacity-70 text-xs">Această memorizare va fi exclusiv în telefonul tău și în posesia ta.</span>
    </p>
  </div>

  <!-- Modal pentru afișarea inspirației -->
  <div id="inspirationModal" class="modal">
    <div class="modal-content">
      <span class="close-button" id="closeModalButton">&times;</span>
      <h2 class="text-xl font-semibold mb-4 text-center">✨ Inspirația Ta ✨</h2>
      <div id="loadingSpinner" class="loading-spinner"></div>
      <p id="inspirationText" class="text-gray-700 leading-relaxed text-center"></p>
    </div>
  </div>

  <script>
    const sun = document.getElementById('sun');
    const sunText = document.getElementById('sun-text');
    const recSection = document.getElementById('rec-section');
    const inspirationButton = document.getElementById('inspirationButton');
    const inspirationModal = document.getElementById('inspirationModal');
    const closeModalButton = document.getElementById('closeModalButton');
    const inspirationText = document.getElementById('inspirationText');
    const loadingSpinner = document.getElementById('loadingSpinner');

    let holdTimeout;
    let isRecording = false; // Stare pentru a ști dacă înregistrarea este activă

    // Funcția pentru a începe animația și a pregăti înregistrarea
    function startRecordingProcess() {
      sun.classList.add('expanding'); // Activează animația de expansiune
      sunText.textContent = 'Inspiră profund'; // Schimbă textul la "Inspiră profund"

      // După 2 secunde, finalizează animația și pregătește UI-ul pentru înregistrare
      setTimeout(() => {
        sun.classList.remove('expanding'); // Oprește expansiunea
        sunText.textContent = '🎙️'; // Schimbă textul la iconița de microfon
        sun.classList.add('active'); // Adaugă clasa 'active' pentru a afișa egalizatorul
        recSection.style.display = 'flex'; // Afișează secțiunea de înregistrare
        isRecording = true; // Setează starea de înregistrare la adevărat
        // Aici ar începe logica reală de înregistrare (Web Speech API, etc.)
        // Pentru MVP, aceasta este doar o simulare vizuală
        console.log("Începe înregistrarea...");

        // Redirecționează către pagina de jurnal după o scurtă întârziere
        setTimeout(() => {
          window.location.href = 'journal.html';
        }, 1000); // Redirecționează după 1 secundă de la activare
      }, 2000); // Așteaptă 2 secunde pentru animația "Inspiră profund"
    }

    // Ascultă evenimentul de apăsare a butonului (mousedown)
    sun.addEventListener('mousedown', () => {
      // Setează un timeout pentru a detecta o apăsare lungă (1.2 secunde)
      holdTimeout = setTimeout(startRecordingProcess, 1200);
    });

    // Anulează timeout-ul dacă butonul este eliberat prea repede
    sun.addEventListener('mouseup', () => {
      clearTimeout(holdTimeout);
    });
    // Anulează timeout-ul dacă mouse-ul părăsește zona butonului
    sun.addEventListener('mouseleave', () => {
      clearTimeout(holdTimeout);
    });

    // Funcția pentru a genera inspirație folosind Gemini API
    async function generateInspiration() {
      inspirationText.textContent = ''; // Curăță textul anterior
      loadingSpinner.style.display = 'block'; // Afișează spinner-ul
      inspirationModal.style.display = 'flex'; // Afișează modalul

      try {
        let chatHistory = [];
        const prompt = "Generează o frază scurtă, pozitivă și inspirațională despre auto-reflecție, creștere personală sau liniște interioară. Fraza să fie concisă și să inspire calm.";
        chatHistory.push({ role: "user", parts: [{ text: prompt }] });
        const payload = { contents: chatHistory };
        const apiKey = ""; // Lăsați gol pentru ca Canvas să furnizeze cheia API
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

        const response = await fetch(apiUrl, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload)
        });

        const result = await response.json();

        if (result.candidates && result.candidates.length > 0 &&
            result.candidates[0].content && result.candidates[0].content.parts &&
            result.candidates[0].content.parts.length > 0) {
          const text = result.candidates[0].content.parts[0].text;
          inspirationText.textContent = text;
        } else {
          inspirationText.textContent = "Nu am putut genera inspirație. Te rugăm să încerci din nou.";
          console.error("Structura răspunsului API este neașteptată:", result);
        }
      } catch (error) {
        inspirationText.textContent = "A apărut o eroare la generarea inspirației. Verifică conexiunea la internet.";
        console.error("Eroare la apelul Gemini API:", error);
      } finally {
        loadingSpinner.style.display = 'none'; // Ascunde spinner-ul
      }
    }

    // Ascultă evenimentul de click pe butonul de inspirație
    inspirationButton.addEventListener('click', generateInspiration);

    // Închide modalul la click pe butonul de închidere
    closeModalButton.addEventListener('click', () => {
      inspirationModal.style.display = 'none';
    });

    // Închide modalul la click în afara conținutului său
    window.addEventListener('click', (event) => {
      if (event.target == inspirationModal) {
        inspirationModal.style.display = 'none';
      }
    });
  </script>
</body>
</html>
